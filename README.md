Здесь представлены два проекта: прогнозирование продаж медикаментов с использованием линейной регрессии и пример ETL пайплайна для расчета доли продукта в объеме продаж компании.

---

## 1. Прогнозирование продаж медикаментов

**Описание:**  
Код направлен на прогнозирование продаж лекарственных средств на основе исторических данных по продажам. Используется метод линейной регрессии. Датасет взят с Kaggle: https://www.kaggle.com/datasets/shivamkapoor5034/pharmaceutical-monthly-sales 

**Основные шаги:**  
- Предобработка данных: преобразование даты, установка индекса, сортировка по времени.  
- Генерация признаков: лаги, скользящее среднее, минимум и максимум за 12 месяцев.  
- Деление данных на тренировочную и валидационную выборки.  
- Анализ корреляции и отбор топ-5 признаков.  
- Обучение модели линейной регрессии.  
- Вычисление метрик MAE, RMSE, MAPE.  
- Визуализация фактических и прогнозных продаж.

**Результаты:**  
- MAE: 73.28  
- RMSE: 91.47 
- MAPE: 1.5%  

**Стек:**  
`Python`, `pandas`, `numpy`, `scikit-learn`, `matplotlib`, `seaborn`, `plotly`

---

## 2. ETL пайплайн для расчета доли продукта

**Описание:**  
Пример ETL пайплайна для расчета доли продукта в общем объеме продаж компании. Подходит для анализа динамики продуктовой линейки, распределения бюджета и инвестиционных приоритетов.  

**Основные шаги:**  
1. Создание контекста расчета (год, месяц, флаг конца года).  
2. Подготовка исторических данных о продажах.  
3. Агрегация продаж по компаниям и продуктам.  
4. Вычисление общей суммы продаж по компании.  
5. Расчет доли продукта в общем объеме.  
6. Формирование финальной витрины.


**Стек:**  
`PostgreSQL`

## 3. CRM Sales Funnel Analytical Mart

**Описание:**
Код реализует CRM витрину для анализа продаж, выручки и состояния сделок. Витрина позволяет оценивать эффективность каналов продаж, статус платежей и состояние воронки продаж на уровне сделки и счета.

**Основные шаги:**

1. Подготовка данных по сделкам и счетам из CRM-системы.
2. Фильтрация удалённых записей.
3. Формирование логики выручки (учёт только оплаченных счетов)
4. Расчёт признаков воронки продаж.
5. Агрегация данных по гранулярности deal_id + invoice_id.
6. Создание финальной витрины.

**Стек:**
`PostgreSQL`
